# libSvc

libSvc is a library meant to provide a way for a stand-alone binary image to communicate with 'services' (ex. APIs provided by dynamically loaded shared libraries) by way of assigning a pointer and name to an id

### Usage:
##### Functions called by the loader only:
`svcInit(const char *svc_image, size_t off):`

initialize libSvc, returns error code (foun in include/svc.h)

> svc_img: name of the file which contains binary code generated by svc/mkimage.sh

> off:     offset into svc_image at which the code begins

`svcClose():`

deinitialize libSvc, returns error code

---

##### Functions called by loader or the loaded image:
`long svc(long SVC):`

queries the registered service, returns a pointer to it cast to a long

> SVC: id of service (valid ids 0-15)

`const char *svcQueryName(long SVC):

queries name of service

`void svcRegister(long SVC, void *ptr, const char *name):`

registers a service with id 'SVC' (valid ids 0-15), which upon querying with svc() will return 'ptr' cast to a long and upon querying for it's name will return 'name'

> SVC: id of service (valid ids 0-15)

> ptr: any pointer

> name: NULL-terminated string that gets copied to an internal buffer, which means the original need not be kept after svcRegister(), and truncated to 15 characters (not counting NULL)

---

### NOTE:
In all cases SVC is *NOT* range checked when an out of range id is given crashes or other undefined behaviour will occur!
